## Event Driven MicroService
### Event Driven?
* 시스템 내 외부에 발생한 주목할 만한 상태의 변화에 기반한 동작
* Event Driven 아키텍쳐는 특정 서비스에서 다른 서비스가 관심을 가질 수 있는 작업을 수행할 때 해당 서비스는 이 작업을 이벤트로써 이벤트 스토어(메세지 Queue)에 기록
* 다른 서비스는 기록된 이벤트들을 구독, 자신들의 작업을 수행

### 왜 Event Driven?
* 느슨한 결합이 가능하므로 분산 시스템, 마이크로서비스 간 협업 관계에 있어 상호 의존성을 배제할 수 있음

### 이벤트 처리 방식
* 대기열(Queue) 방식 - Point to Point
  * 대기열 방식은 최초 Consumer가 가져간 베세지는 다른 소비자가 가져갈 수 없음 (소비의 개념)
* 토픽(Topic) 방식 - Pub-Sub
  * Pub-Sub은 모든 구독자(subscriber)들이 메세지를 최소 1번 이상(복제본) 가져갈 수 있음
 
### 이벤트를 저장, 소비하는 방식
* 대기열 방식 - Point to Point
  * 여러 작업자에게 작업을 분산시켜야 하고 중복 처리를 피하려는 시나리오에 유용
  * ex) 주문처리 마이크로서비스
* 토픽 방식 - Pub-Sub
  * 동일한 유형의 이벤트에 관심이 있는 여러 소비자에게 이벤트를 브로드캐스트해야 할 때 적합
  * ex) 소셜 플랫폼의 구독 서비스
* 선택기준의 핵심
  * 모든 consumer들이 모든 메세지를 전부 수신해야 하는가?

### 대표적인 메세지 브로커
* Rabbit MQ (Active MQ)
  * 강력한 메세지 라우팅 기능, Queue의 다양한 옵션 설정
* Amazon SQS / SNS
  * 메세지 브로커를 설정할 필요 없는 단순 대기열과 주제 서비스 (SaaS)
  * 단순히 Queue 용도로만 사용할 경우 적절한 대안이 될 수 있음
* Apache Kafka
  * 범용 메세지 브로커 중에서는 가장 뛰어난 성능, 대표적인 Pub-Sub(Topic) 기반 기술
  * 최소 1번의 메세지 전송 보장, 파일 기반 메세지 로그 저장
 
### 배민의 Event Driven 적용 예시 - AWS SQS + AWS SNS의 조합

### Zero-Payload 방식
1. 이벤트 전송 (변경에 대한 Notification, key 정보)
2. 이벤트 수신
3. 변경 내용 조회 (API)
* Zero-payload 방식은 이벤트 전송 처리 방식의 하나
* 메세지 발행자는 변경 시 모든 데이터를 다 보낼 수 없음 (필요없음) - 구독자마다 요구하는 dataset은 다 다름

### MSA를 도입한 이후 직면하게 되는 문제점
* 개발 복잡도와 숙련도
* 통합 테스트 및 디버깅의 어려움
* 배포의 복잡도
* **분산된 서비스 간 트랜잭션 처리 및 데이터 동기화**

